{
  "uid": "redmine-enterprise",
  "title": "Redmine Enterprise Observability",
  "tags": ["Redmine", "Enterprise", "Monitoring"],
  "timezone": "browser",
  "schemaVersion": 36,
  "version": 1,
  "refresh": "30s",
  "panels": [

    { "type": "stat", "title": "Overall Redmine Availability", "targets": [{ "expr": "probe_success{instance=\"http://redmine-app-alb-2020296281.eu-west-3.elb.amazonaws.com/\"}", "refId": "A" }] },

    { "type": "graph", "title": "CPU Usage (Redmine Host)", "targets": [{ "expr": "100 - (avg by(instance) (rate(node_cpu_seconds_total{mode=\"idle\",instance=\"10.0.2.159:9100\"}[5m])) * 100)", "refId": "B" }] },

    { "type": "graph", "title": "Load Average (Redmine Host)", "targets": [{ "expr": "node_load1{instance=\"10.0.2.159:9100\"}", "refId": "C" }] },

    { "type": "graph", "title": "Memory Usage % (Redmine Host)", "targets": [{ "expr": "(node_memory_MemTotal_bytes{instance=\"10.0.2.159:9100\"} - node_memory_MemAvailable_bytes{instance=\"10.0.2.159:9100\"}) / node_memory_MemTotal_bytes{instance=\"10.0.2.159:9100\"} * 100", "refId": "D" }] },

    { "type": "graph", "title": "Disk Usage % (Root)", "targets": [{ "expr": "100 - (node_filesystem_avail_bytes{instance=\"10.0.2.159:9100\",mountpoint=\"/\"} / node_filesystem_size_bytes{instance=\"10.0.2.159:9100\",mountpoint=\"/\"} * 100)", "refId": "E" }] },

    { "type": "graph", "title": "Disk IO (Read/Write)", "targets": [
        { "expr": "rate(node_disk_read_bytes_total{instance=\"10.0.2.159:9100\"}[5m])", "refId": "F" },
        { "expr": "rate(node_disk_written_bytes_total{instance=\"10.0.2.159:9100\"}[5m])", "refId": "G" }
      ]
    },

    { "type": "graph", "title": "Network IO (RX/TX)", "targets": [
        { "expr": "rate(node_network_receive_bytes_total{instance=\"10.0.2.159:9100\",device!=\"lo\"}[5m])", "refId": "H" },
        { "expr": "rate(node_network_transmit_bytes_total{instance=\"10.0.2.159:9100\",device!=\"lo\"}[5m])", "refId": "I" }
      ]
    },

    { "type": "graph", "title": "Redmine HTTP Response Time", "targets": [{ "expr": "probe_duration_seconds{instance=\"http://redmine-app-alb-2020296281.eu-west-3.elb.amazonaws.com/\"}", "refId": "J" }] },

    { "type": "graph", "title": "DNS Duration", "targets": [{ "expr": "probe_dns_duration_seconds{instance=\"http://redmine-app-alb-2020296281.eu-west-3.elb.amazonaws.com/\"}", "refId": "K" }] },

    { "type": "graph", "title": "TLS Handshake Duration", "targets": [{ "expr": "probe_tls_duration_seconds{instance=\"http://redmine-app-alb-2020296281.eu-west-3.elb.amazonaws.com/\"}", "refId": "L" }] },

    { "type": "graph", "title": "Postgres Active Connections", "targets": [{ "expr": "pg_stat_activity_count", "refId": "M" }] },

    { "type": "graph", "title": "Postgres Max Connections", "targets": [{ "expr": "pg_settings_max_connections", "refId": "N" }] },

    { "type": "graph", "title": "Transaction Throughput", "targets": [{ "expr": "rate(pg_stat_database_xact_commit[5m])", "refId": "O" }] },

    { "type": "graph", "title": "Transaction Rollbacks", "targets": [{ "expr": "rate(pg_stat_database_xact_rollback[5m])", "refId": "P" }] },

    { "type": "graph", "title": "Postgres Deadlocks", "targets": [{ "expr": "pg_stat_database_deadlocks", "refId": "Q" }] },

    { "type": "graph", "title": "Postgres Cache Hit Ratio", "targets": [{ "expr": "(sum(pg_stat_database_blks_hit) / (sum(pg_stat_database_blks_hit) + sum(pg_stat_database_blks_read))) * 100", "refId": "R" }] },

    { "type": "graph", "title": "Postgres DB Disk IO (Read)", "targets": [{ "expr": "rate(pg_stat_database_blks_read[5m])", "refId": "S" }] },

    { "type": "graph", "title": "Postgres DB Disk IO (Hit)", "targets": [{ "expr": "rate(pg_stat_database_blks_hit[5m])", "refId": "T" }] },

    { "type": "stat", "title": "System Uptime (Redmine Host)", "targets": [{ "expr": "node_boot_time_seconds{instance=\"10.0.2.159:9100\"}", "refId": "U" }] },

    { "type": "stat", "title": "System Uptime (Monitoring Host)", "targets": [{ "expr": "node_boot_time_seconds{instance=\"10.0.3.115:9100\"}", "refId": "V" }] },

    { "type": "stat", "title": "Redmine Docker Uptime", "targets": [{ "expr": "time() - container_start_time_seconds{name=\"redmine\"}", "refId": "W" }] },

    { "type": "stat", "title": "Grafana Docker Uptime", "targets": [{ "expr": "time() - container_start_time_seconds{name=\"grafana\"}", "refId": "X" }] },

    { "type": "stat", "title": "Postgres Exporter Status", "targets": [{ "expr": "up{job=\"postgres-exporter\"}", "refId": "Y" }] },

    { "type": "stat", "title": "Blackbox Exporter Status", "targets": [{ "expr": "up{job=\"blackbox-exporter\"}", "refId": "Z" }] },

    { "type": "stat", "title": "Prometheus Health", "targets": [{ "expr": "up{job=\"prometheus\"}", "refId": "AA" }] },

    { "type": "stat", "title": "Node Exporter Health", "targets": [{ "expr": "up{job=\"node-exporter\"}", "refId": "AB" }] },

    { "type": "stat", "title": "Overall Monitoring Health", "targets": [{ "expr": "sum(up)", "refId": "AC" }] }
  ]
}